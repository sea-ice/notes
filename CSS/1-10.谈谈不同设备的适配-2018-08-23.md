我们的网页需要适配的设备不外乎有两种，一种是大屏设备（包括pc、ipad等等），另外一种则是移动端设备。先谈谈移动设备的适配方案，目前比较常见的就是rem布局这种过渡方案以及使用vw单位进行布局。

### rem布局

关于rem布局，业界比较出名的应该要数lib-flexible这个库了，它将1rem设置为视口宽度的1/10，也就是将html元素的font-size设置为视口宽度的1/10。

需要注意的是在Chrome等主流浏览器中设置元素的font-size CSS属性如果小于12px，都会默认按照12px计算，也就是最小的字体大小就是12px。

### 使用vw单位

视口被均分为100单位的vw，目前在移动端设备上支持良好，可以直接使用。有了vw这个单位，rem布局作为过渡方案可以考虑抛弃了。简单用法就是配合postcss-px-to-viewport这个PostCSS插件。在移动端项目中只需要对这个插件稍微进行配置（主要设置设计稿对应的设备宽度），就可以在项目中直接按照设计稿上的尺寸写px，然后插件便会自动帮忙把px单位转化为vw，从而做到适配不同移动设备终端。不得不说，vw单位就是开发移动端页面的神器。

具体到项目的开发中，在以下场景中我们可以使用vw：

1. 容器的适配可以用vw；
2. 文本字体大小可以用vw；
3. 大于1px的边框、圆角、阴影都可以使用vw；
4. 内距和外距也可以使用vw

#### 1px线的绘制

除此之外，还需要解决的就是在Retina屏幕下1px线的绘制问题。为此可以使用PostCSS的postcss-write-svg插件。然后在项目中使用如下所示：

```css
@svg 1px-border { 
  height: 2px;
  @rect { 
    fill: var(--color, black); 
    width: 100%; 
    height: 50%; 
  } 
} 
.example { 
  border: 1px solid transparent; 
  border-image: svg(1px-border param(--color #00b1ff)) 2 2 stretch; 
}
```

经过PostCSS编译之后的结果如下：

```css
.example { 
  border: 1px solid transparent; 
  border-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' height='2px'%3E%3Crect fill='%2300b1ff' width='100%25' height='50%25'/%3E%3C/svg%3E") 2 2 stretch; 
}
```

除此之外，也可以使用background属性来实现1px的细线。代码示例：

```css
@svg square {
  @rect {
    fill: var(--color, black);
    width: 100%;
    height: 100%;
  }
}

.example {
  background: white svg(square param(--color #00b1ff));
}
```

更朴素的方案是通过transform:scale属性来实现。前提是需要先判断当前终端是否为Retina屏（在根元素上添加hairlines类），然后再对目标元素应用以下样式：

```css
.hairlines li{ 
  position: relative; 
  border:none; 
} 
.hairlines li:after{ 
  content: ''; 
  position: absolute; 
  left: 0; 
  background: #000; 
  width: 100%; 
  height: 1px; 
  transform: scaleY(0.5); 
  transform-origin: 0 0; 
}
```

当然如果要实现多个方向上的边框，这种方案还是比较麻烦的。

#### 图片的适配

对于Retina屏，另外一个需要解决的问题就是图片尺寸的适配。由于同样的CSS尺寸在Retina屏幕上占据的物理像素会更多，所以在Retina屏幕上就不能直接应用正常屏幕下的图片，而应该按照屏幕的dpr值选择使用放大dpr倍的图片，才不会造成图片的模糊不清晰。要想在各种dpr值的屏幕下使用正确尺寸的图片，可以借助img配合其srcset属性来加载图片。srcset属性用法如下（引自MDN）：

srcset属性是以逗号分隔的一个或多个字符串列表表明一系列用户代理使用的可能的图像。每一个字符串由以下组成：

1. 一个图像的 URL。
2. 可选的，空格后跟以下的其一：
  - 一个宽度描述符，这是一个正整数，后面紧跟 'w' 符号。该整数宽度除以sizes属性给出的资源（source）大小来计算得到有效的像素密度，即换算成和x描述符等价的值。
  - 一个像素密度描述符，这是一个正浮点数，后面紧跟 'x' 符号。

如果没有指定源描述符，那它会被指定为默认的 1x。在相同的 srcset 属性中混合使用宽度描述符和像素密度描述符时，会导致该值无效。
