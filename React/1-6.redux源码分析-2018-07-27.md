### redux

redux 是基于 Flux 思想的状态管理库。

### 和react搭配使用

要实现我们的react应用连接redux中的store，需要借助react-redux。这个库主要提供了两个API，分别是Provider组件和connect高阶组件。

#### Provider

Provider组件实现的功能很简单（提供context），就是接收redux中的store并放入context中，然后通过React Context API（旧版本的context）使得我们的应用中使用connect包裹的组件（需要使用connect包裹之后的组件才能访问Provider提供的context）可以通过context访问到redux创建的store，也就能获取到应用的状态。

旧版本的context API允许上层组件将数据放入到context中，内部嵌套的任意层级的组件都可以通过组件的context属性获取到context中的数据。具体做法是通过定义组件的getChildContext方法返回需要放到context中的数据，该方法会在组件的props和state发生改变时被调用。除了需要定义getChildContext方法之外，还需要在组件上定义childContextTypes静态属性，列出context中每个数据字段的类型。

上层组件定义好放到context中的数据之后，嵌套的组件可以通过定义contextTypes静态属性来获取context中的数据，同样也是列出组件需要获取的数据字段的类型。如果contextTypes静态属性没有定义，组件实例的context属性则为空对象，也就获取不到context中的数据。在定义了contextTypes静态属性的子组件中，`constructor(props, context)`构造方法、
`componentWillReceiveProps(nextProps, nextContext)`、
`shouldComponentUpdate(nextProps, nextState, nextContext)`、
`componentWillUpdate(nextProps, nextState, nextContext)`等方法都会接收额外的context参数。

前面提到过，getChildContext方法会在上层组件的props和state发生改变时被调用。意味着如果在context中引用了props或者state中的属性，当这部分属性发生变化时，子组件从context中获取到的这部分数据也会得到相应的更新，但是有一个前提就是在提供了context的上层组件到使用了context的子组件之间的所有组件的shouldComponentUpdate方法必须返回true，否则即使context中的数据更新了，使用了context的其他组件获取到的数据也不会相应得到更新。