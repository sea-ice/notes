### 绑定事件

DOM提供了DOM 0级和DOM 2级的事件绑定方式，其中DOM 2级的方式就是通过addEventListener方法去绑定，可以对同一个节点多次调用addEventListener方法给同一种事件类型绑定多个处理函数。在事件处理函数中可以调用事件对象的stopImmediatePropagation方法来跳过对同一种事件类型后续绑定的事件处理函数的执行。举例：

```javascript
let container = document.getElementById('container')
container.addEventListener('click', e => {
  console.log('first')
  e.stopImmediatePropagation()
})
container.addEventListener('click', e => {
  console.log('second')
})
```

当该元素被点击时，只会执行第一次第一个事件处理函数，后续的处理函数因为第一个处理函数调用了事件对象上的stopImmediatePropagation方法而不会被执行。

### 常用事件

#### 页面加载相关

##### load事件

很多元素都可以订阅load事件，常见的包括img元素、script元素等等这些用于加载资源的元素，另外还有window对象（当页面解析渲染完成以及页面上所有资源都加载完成时就会触发此事件）。但并不是所有的元素都可以订阅此事件，比如canvas元素等等。

##### DOMContentLoaded事件

与load事件相关的事件就是DOMContentLoaded事件，该事件通常是在document对象上订阅的，触发时机则是在页面DOM解析完成时触发，而无需等待页面上的资源都加载完毕才触发。

#### 交互类事件

##### mousedown+mousemove+mouseup

通过以上三个事件的组合可以实现长按拖拽事件，比如选中页面上的某块区域。

##### input/change

input事件一般用于input、textarea等文本输入控件上，并且在用户每输入一个字符时就会触发一次。在事件处理函数中通过 `e.preventDefault` 方法并不能阻止用户输入（可通过监听keydown事件来实现类似的功能，但是通过 `e.preventDefault` 方法只能阻止用户输入英文字符，**对于输入中文字符时就又无能为力**了，同时还要注意在keydown事件处理函数中通过事件对象只能获取到在输入当前字符之前文本框中的内容，即不包含当前输入的字符）。更直接有效的办法是通过**设置控件的value值**来限制输入的字符长度。

change事件也通常用于表单控件，而且适用范围更广，比如file类型的input、select等。对于传统的输入型控件（例如text类型的input、textarea）,只有当控件内容发生更改**并且失去焦点**时才会触发change事件。

##### compositionstart/compositionend

当用户输入中文字符的过程中，在选择最终的中文之前，输入的一系列字符会持续触发keydown和input事件，这对于我们判断当前输入框内容的长度会造成干扰。可以通过监听控件的compositionstart和compositionend事件，前者是在用户使用中文输入法输入第一个拼音字母时触发，后者是在用户输完拼音之后点击数字键选择汉字的时候触发。可以考虑监听这两个事件，使用一个标志位表示用户正在输入拼音字母，从而屏蔽输入拼音这个过程对输入框内容长度判断的影响。

以上这些事件在输入拼音时的触发顺序：

`keydown` -> `compositionstart` -> `input` -> `keyup`

`keydown` -> `input` -> `compositionstart` -> `keyup`
